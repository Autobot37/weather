============================================================
                 Experiment Start
============================================================
Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: bf16

train data: 71436, valid data: 20, test_data: 20
Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
Main Model Parameters: 48.87M
============ Running training ============
    Num examples = 71436
    Num Epochs = 1
    Instantaneous batch size per GPU = 1
    Total train batch size (w. parallel, distributed & accumulation) = 1
    Total optimization steps = 71436
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 0.0001
Data Loading Time: 0.11513376235961914
True
gpu_nums: 1, gpu_id: 0
Load checkpoint /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffearthformer_sevir_None/checkpoints/ckpt-10000.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffearthformer_sevir_None/checkpoints
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
backbone_net.torch_nn_module.decoder.cross_blocks.0.0.ffn_l.0.ffn_1.weight
backbone_net.torch_nn_module.decoder.cross_blocks.0.0.ffn_l.0.ffn_1.bias
backbone_net.torch_nn_module.decoder.cross_blocks.0.0.ffn_l.0.ffn_2.weight
backbone_net.torch_nn_module.decoder.cross_blocks.0.0.ffn_l.0.ffn_2.bias
 ========= Running Test at Step 10000 ==========
Save checkpoint 10000 to /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffearthformer_sevir_None/checkpoints
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.96s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.96s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 13.00s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.97s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.97s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.98s/it]
sampling frags:: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.99s/it]
Test Samples: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [05:00<00:00, 15.04s/it]
Test Samples: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [05:00<00:00, 15.04s/it]
****************************** < Evaluation Results: > ******************************
Total 40 samples with 10 seq_len.
******************************************************************************************
====================Threshold: 16 with melthod 1====================
<CSI> : 0.24564626768333508; [0.36080466 0.33883169 0.18636848 0.25922226 0.12087043 0.18670666
 0.31185118 0.24665262 0.23260848 0.21254622]
<FAR> : 0.7407218563742621; [0.6299432  0.64952875 0.8110407  0.73031238 0.877896   0.80809069
 0.64643557 0.73463779 0.74910189 0.77023162]
<POD> : 0.8447162702471728; [0.93519564 0.91073296 0.93147207 0.8697923  0.92286447 0.87320935
 0.72552148 0.77769513 0.76138981 0.7392895 ]
<HSS> : 0.32153020913721736; [0.4837483  0.45666398 0.23312828 0.34892895 0.11652793 0.23402529
 0.42543026 0.33038043 0.30928289 0.27718578]
< CSI_POOL 4x4 > : 0.2146003467949435; CSI_POOL 16x16: 0.2795047537683889
====================Threshold: 74 with melthod 1====================
<CSI> : 0.33873878846800753; [0.52935689 0.4657459  0.43377792 0.37388625 0.36716092 0.33026468
 0.24944758 0.23732499 0.21413247 0.18629028]
<FAR> : 0.36181183001264144; [0.21624099 0.22341262 0.2939158  0.30843074 0.37372877 0.3747793
 0.38904381 0.44286893 0.47796428 0.51773306]
<POD> : 0.4106006166403833; [0.61989274 0.53780547 0.52936229 0.44870747 0.47017909 0.41178711
 0.2965529  0.292507   0.26635211 0.23285999]
<HSS> : 0.48960497444576745; [0.68754956 0.63032936 0.59919856 0.53809073 0.53028004 0.48968552
 0.39257985 0.37638328 0.34534243 0.3066104 ]
< CSI_POOL 4x4 > : 0.34450334256195553; CSI_POOL 16x16: 0.3618424699296048
====================Threshold: 133 with melthod 1====================
<CSI> : 0.0743446457821283; [0.27689594 0.16788847 0.11578394 0.06959195 0.05787581 0.01946399
 0.01189506 0.01011997 0.00980796 0.00412336]
<FAR> : 0.7073978518983036; [0.49955175 0.53574661 0.60466682 0.63179298 0.72912621 0.82503365
 0.77399381 0.78583765 0.7965812  0.89164786]
<POD> : 0.09379913617191009; [0.38266433 0.20823186 0.14070111 0.0790288  0.06855598 0.02143093
 0.0124002  0.01051026 0.01019971 0.00426818]
<HSS> : 0.12722142944600415; [0.43260713 0.28658502 0.20665401 0.12947066 0.10867364 0.03775281
 0.02330765 0.01985374 0.01924014 0.00806949]
< CSI_POOL 4x4 > : 0.09576668853120744; CSI_POOL 16x16: 0.13163694650370666
====================Threshold: 160 with melthod 1====================
<CSI> : 0.03189873065964098; [0.13859169 0.06364209 0.06049341 0.03148971 0.01605505 0.00104058
 0.00200904 0.00502513 0.         0.00064061]
<FAR> : 0.8649074384455245; [0.76468103 0.81050657 0.81118143 0.8        0.89489489 0.97058824
 0.93333333 0.775      1.         0.88888889]
<POD> : 0.04848586131581163; [0.25215029 0.08744589 0.08173516 0.03602771 0.01859724 0.00107759
 0.00206718 0.00511364 0.         0.00064392]
<HSS> : 0.05862559237152733; [ 2.43150815e-01  1.19450461e-01  1.13886614e-01  6.09515245e-02
  3.15097923e-02  2.05680503e-03  3.99037063e-03  9.98687049e-03
 -4.70871778e-06  1.27737943e-03]
< CSI_POOL 4x4 > : 0.05563124432334242; CSI_POOL 16x16: 0.07327858496525586
====================Threshold: 181 with melthod 1====================
<CSI> : 0.010154448280648959; [0.0311174  0.04228856 0.02813853 0.         0.         0.
 0.         0.         0.         0.        ]
<FAR> : 0.7806868523076509; [0.94977169 0.92410714 0.93298969 1.         1.         1.
 1.         1.         0.         0.        ]
<POD> : 0.020904420694566345; [0.07560137 0.08717949 0.04626335 0.         0.         0.
 0.         0.         0.         0.        ]
<HSS> : 0.01960630171314754; [ 6.03009426e-02  8.11131031e-02  5.47000553e-02 -2.24884588e-05
 -1.73331884e-05 -2.62552633e-06 -5.04630913e-06 -3.59038404e-06
  0.00000000e+00  0.00000000e+00]
< CSI_POOL 4x4 > : 0.03303684879288437; CSI_POOL 16x16: 0.06853582554517135
====================Threshold: 219 with melthod 1====================
<CSI> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<FAR> : 0.4; [1. 1. 1. 1. 0. 0. 0. 0. 0. 0.]
<POD> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<HSS> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
< CSI_POOL 4x4 > : 0.0; CSI_POOL 16x16: 0.0
********************Overall Avg Metrics on Thresholds (16, 74, 133, 160, 181, 219)********************
[ avg_csi ] : 0.11679714681229347; [ avg_far ] : 0.6425876381730637; [ avg_pod ] : 0.23641771751164067; [ avg_hss] : 0.1694314178522773
[ avg_csi_pool 4x4 ] : 0.1239230785007222; [ avg_csi_pool 16x16 ]: 0.15246643011868793
====================Losses with 10 seq_len====================
<MSE> : 228.3758544921875; [153.14014 173.85858 243.9458  212.96628 313.16913 265.99237 180.19
 235.12947 245.0223  260.34442]
<MAE> : 12.237001419067383; [10.577123  11.273972  13.781794  12.126739  15.597916  13.808268
  9.245592  11.860579  11.899235  12.1988125]
<RMSE> : 14.830438613891602; [12.25094   13.0317745 15.497368  14.407745  17.565268  16.132
 13.085371  15.079987  15.392473  15.861447 ]
<PSNR> : 24.890517947739646; [26.46316376 25.94359561 24.39905134 25.08317623 23.30748354 24.08145521
 26.06223766 24.72679354 24.54817056 24.29005203]
<SSIM> : 0.25512545033596373; [0.27216815 0.25996916 0.21826594 0.2452815  0.19870501 0.22424163
 0.3345108  0.2653576  0.26639917 0.26635556]
<CRPS> : 0.04798824271272072; [0.04147891 0.04421165 0.05404624 0.04755584 0.06116828 0.05415007
 0.03625722 0.04651207 0.04666366 0.04783848]
<LPIPS> : 0.3253571689128876; [0.28717846 0.2909054  0.32237723 0.3183102  0.3419234  0.33197448
 0.32323763 0.33634886 0.34114358 0.36017245]
==========================================================================================
Test Results: {'csi': 0.11679714681229347}
==============================
  File "/home/vatsal/NWM/DiffCast/run.py", line 575, in <module>
    main()
  File "/home/vatsal/NWM/DiffCast/run.py", line 564, in main
    exp.train()
  File "/home/vatsal/NWM/DiffCast/run.py", line 446, in train
    pbar.update(1)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/std.py", line 1243, in update
    self.refresh(lock_args=self.lock_args)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/std.py", line 1348, in refresh
    self.display()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/std.py", line 1496, in display
    self.sp(self.__str__() if msg is None else msg)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/std.py", line 1152, in __str__
    return self.format_meter(**self.format_dict)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/std.py", line 646, in format_meter
    return disp_trim(res, ncols) if ncols else res
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/utils.py", line 389, in disp_trim
    if len(data) == disp_len(data):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/utils.py", line 382, in disp_len
    return _text_width(RE_ANSI.sub('', data))
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/utils.py", line 374, in _text_width
    return sum(2 if east_asian_width(ch) in 'FW' else 1 for ch in str(s))
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/tqdm/utils.py", line 374, in <genexpr>
    return sum(2 if east_asian_width(ch) in 'FW' else 1 for ch in str(s))
KeyboardInterrupt
