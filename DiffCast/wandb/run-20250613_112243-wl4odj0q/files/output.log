============================================================
                 Experiment Start
============================================================
Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

Loading data
train data: 9921, valid data: 20, test_data: 20
Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
Batch Shape: torch.Size([6, 25, 1, 128, 128]), Type: torch.float32
Batch Shape: torch.Size([12, 25, 1, 128, 128]), Type: torch.float32
Batch Shape: torch.Size([12, 25, 1, 128, 128]), Type: torch.float32
Building model
Main Model Parameters: 2.42M
============ Running training ============
    Num examples = 9921
    Num Epochs = 21
    Instantaneous batch size per GPU = 6
    Total train batch size (w. parallel, distributed & accumulation) = 6
    Total optimization steps = 208341
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1e-05
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 1e-05
Data Loading Time: 0.32999467849731445
True
gpu_nums: 1, gpu_id: 0
Training Now
Epoch 0/21, Step 212/9921:   0%|          | 213/208341 [00:26<5:53:05,  9.82it/s, lr=2.13e-6, total_loss=1.48]Traceback (most recent call last):
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 591, in <module>
    main()
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 580, in main
    exp.train()
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 417, in train
    for i, batch in enumerate(self.train_loader):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/accelerate/data_loader.py", line 462, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1491, in _next_data
    idx, data = self._get_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1453, in _get_data
    success, data = self._try_get_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1284, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Traceback (most recent call last):
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 591, in <module>
    main()
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 580, in main
    exp.train()
  File "/home/vatsal/NWM/weather/DiffCast/run.py", line 417, in train
    for i, batch in enumerate(self.train_loader):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/accelerate/data_loader.py", line 462, in __iter__
    next_batch = next(dataloader_iter)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1491, in _next_data
    idx, data = self._get_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1453, in _get_data
    success, data = self._try_get_data()
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1284, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 257, in poll
    return self._poll(timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 424, in _poll
    r = wait([self], timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/vatsal/miniconda3/envs/earthformer/lib/python3.9/threading.py", line 1080, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
KeyboardInterrupt
