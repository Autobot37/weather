sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
sampling frags:: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:12<00:00, 12.71s/it]
Test Samples: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [04:55<00:00, 14.78s/it]
****************************** < Evaluation Results: > ******************************
Total 40 samples with 10 seq_len.
******************************************************************************************
====================Threshold: 16 with melthod 1====================
<CSI> : 0.20306249291645823; [0.31403072 0.26960566 0.24001733 0.21410441 0.19249007 0.17614559
 0.16892698 0.15845059 0.14808234 0.14877123]
<FAR> : 0.5628978267970906; [0.42137475 0.47472675 0.5077414  0.53938919 0.56509235 0.58139048
 0.61123904 0.6284369  0.64343084 0.65615657]
<POD> : 0.27145363383686355; [0.40713835 0.35646177 0.3189881  0.28574792 0.256691   0.23319477
 0.23002029 0.21646039 0.20208165 0.20775209]
<HSS> : 0.2316332413515791; [0.38935715 0.32928502 0.2890167  0.25205761 0.22068264 0.19775328
 0.18106764 0.16455995 0.14851967 0.14403276]
< CSI_POOL 4x4 > : 0.259873721349763; CSI_POOL 16x16: 0.37358496056805285
====================Threshold: 74 with melthod 1====================
<CSI> : 0.04857736531762715; [0.10356095 0.07483836 0.0584049  0.04929379 0.04571142 0.03820995
 0.03206993 0.02806316 0.02687242 0.02874877]
<FAR> : 0.7328501481264229; [0.56880786 0.63827782 0.67369324 0.70908885 0.73320375 0.7636734
 0.79374707 0.81326191 0.81836219 0.81638539]
<POD> : 0.055657392103603785; [0.11994726 0.0862249  0.06641319 0.05602538 0.05227885 0.04359243
 0.03658522 0.03197053 0.03057411 0.03296206]
<HSS> : 0.06541885981908277; [0.15633013 0.11004464 0.08389192 0.0682865  0.06099124 0.04805108
 0.03728028 0.03027434 0.02846282 0.03057563]
< CSI_POOL 4x4 > : 0.08295109399992412; CSI_POOL 16x16: 0.2041703999348375
====================Threshold: 133 with melthod 1====================
<CSI> : 0.0017183708474242723; [0.         0.00398132 0.0033179  0.         0.         0.
 0.0045621  0.00342568 0.00189671 0.        ]
<FAR> : 0.5807252205352417; [0.         0.9512997  0.94686985 0.         0.         1.
 0.95861652 0.97196514 0.97850099 0.        ]
<POD> : 0.001890794761119003; [0.         0.00431706 0.00352642 0.         0.         0.
 0.00510119 0.00388737 0.00207591 0.        ]
<HSS> : 0.0017410696274183356; [ 0.00000000e+00  4.91439003e-03  4.30767725e-03  0.00000000e+00
  0.00000000e+00 -3.39081238e-07  5.10577487e-03  2.43046211e-03
  6.52731097e-04  0.00000000e+00]
< CSI_POOL 4x4 > : 0.005357430778476466; CSI_POOL 16x16: 0.029790062160365924
====================Threshold: 160 with melthod 1====================
<CSI> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<FAR> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<POD> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<HSS> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
< CSI_POOL 4x4 > : 0.0; CSI_POOL 16x16: 0.0
====================Threshold: 181 with melthod 1====================
<CSI> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<FAR> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<POD> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<HSS> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
< CSI_POOL 4x4 > : 0.0; CSI_POOL 16x16: 0.0
====================Threshold: 219 with melthod 1====================
<CSI> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<FAR> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<POD> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
<HSS> : 0.0; [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
< CSI_POOL 4x4 > : 0.0; CSI_POOL 16x16: 0.0
********************Overall Avg Metrics on Thresholds (16, 74, 133, 160, 181, 219)********************
[ avg_csi ] : 0.04222637151358494; [ avg_far ] : 0.3127455325764592; [ avg_pod ] : 0.054833636783597726; [ avg_hss] : 0.04979886179968002
[ avg_csi_pool 4x4 ] : 0.05803037435469393; [ avg_csi_pool 16x16 ]: 0.10125757044387605
====================Losses with 10 seq_len====================
<MSE> : 1183.4566650390625; [ 991.0516 1078.5057 1119.0166 1141.5171 1194.3318 1237.471  1258.0144
 1269.9558 1273.2057 1271.4967]
<MAE> : 15.879865646362305; [14.139084 14.918707 15.2432   15.53728  15.929056 16.18732  16.51217
 16.686466 16.70972  16.935652]
<RMSE> : 30.69589614868164; [28.178879 29.389744 29.783081 30.071173 30.734268 31.272964 31.704594
 31.912506 31.976902 31.934855]
<PSNR> : 19.896879220155327; [20.68426519 20.28821878 20.2626871  20.1645043  19.96780492 19.79665882
 19.53228414 19.43434354 19.40585035 19.43217505]
<SSIM> : 0.5257573242559143; [0.56930069 0.54668483 0.54265303 0.53384693 0.52824173 0.52656874
 0.51023618 0.49743428 0.506326   0.49628084]
<CRPS> : 0.06227397860450765; [0.05544738 0.05850473 0.05977725 0.06093052 0.06246689 0.06347967
 0.06475361 0.06543711 0.0655283  0.06641432]
<LPIPS> : 0.4938119053840637; [0.45996276 0.47045952 0.4782098  0.4877922  0.49370557 0.49996367
 0.5042129  0.51721835 0.5128109  0.51378345]
==========================================================================================
Test Results: {'csi': 0.04222637151358494}
==============================
(earthformer) (base) vatsal@questlab:~/NWM/DiffCast