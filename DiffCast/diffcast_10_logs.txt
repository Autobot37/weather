============================================================
                 Experiment Start                           
============================================================
Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: bf16

train data: 10, valid data: 10, test_data: 10
Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
layer  0 input dim  64  hidden dim  128
layer  1 input dim  128  hidden dim  128
layer  2 input dim  128  hidden dim  64
Main Model Parameters: 49.36M
============ Running training ============
    Num examples = 10
    Num Epochs = 20000
    Instantaneous batch size per GPU = 4
    Total train batch size (w. parallel, distributed & accumulation) = 4
    Total optimization steps = 200000
optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 0.0001
Data Loading Time: 0.3350059986114502
True
gpu_nums: 1, gpu_id: 0
Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
milestones: []
Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
****************************** < Evaluation Results: > ******************************
Total 80 samples with 20 seq_len.
******************************************************************************************
====================Threshold: 16 with melthod 1====================
<CSI> : 0.5685456258729393; [0.83383312 0.77544227 0.72572043 0.68663911 0.65324549 0.628259
 0.60643181 0.58376237 0.56408381 0.54742037 0.53335957 0.51765191
 0.50466739 0.4907444  0.47944966 0.46853573 0.45636288 0.44707907
 0.43874155 0.42948256]
<FAR> : 0.2781351717629428; [0.09007922 0.13033295 0.1656597  0.19049815 0.21522645 0.22967313
 0.24612592 0.26554106 0.27986024 0.29480616 0.30469749 0.31664407
 0.32635592 0.33505619 0.34390639 0.35033873 0.35999441 0.3670072
 0.37207343 0.37882662]
<POD> : 0.7153496752119903; [0.90885629 0.87740749 0.8478964  0.81897298 0.79582027 0.77306636
 0.75613878 0.73992995 0.72245625 0.70987442 0.69604687 0.68099766
 0.66798497 0.65196096 0.64038856 0.62694146 0.61396689 0.60352069
 0.5928725  0.58189377]
<HSS> : 0.6518364592229576; [0.88772826 0.84321482 0.80280201 0.76946973 0.73976536 0.71686919
 0.69639337 0.67422232 0.65448221 0.63739756 0.62278315 0.60654214
 0.5926262  0.57752655 0.5652294  0.55299683 0.53955154 0.52894129
 0.51948113 0.50870613]
< CSI_POOL 4x4 > : 0.6218134739735028; CSI_POOL 16x16: 0.7442844752818734
====================Threshold: 74 with melthod 1====================
<CSI> : 0.48273188117764604; [0.79387895 0.72015693 0.66086621 0.61896873 0.5805042  0.55227532
 0.52590829 0.50397481 0.4820201  0.46270835 0.44561058 0.42639848
 0.40995057 0.39423478 0.37897462 0.36484449 0.34980407 0.33895979
 0.32786615 0.31673221]
<FAR> : 0.3315862270885035; [0.10916523 0.156005   0.19872157 0.22913121 0.25362493 0.27407857
 0.2952171  0.31374325 0.33153984 0.34473809 0.35549796 0.37040952
 0.38452326 0.39925115 0.41070519 0.42109427 0.43260906 0.44163984
 0.45067855 0.45935094]
<POD> : 0.616671002875891; [0.8794338  0.83074066 0.7904139  0.75852226 0.72315391 0.69777266
 0.67449279 0.6548593  0.63346194 0.61159041 0.59083273 0.56918758
 0.55109726 0.53419646 0.51499786 0.4966484  0.47703325 0.46312512
 0.44851146 0.4333483 ]
<HSS> : 0.607463154103858; [0.87420445 0.82185157 0.77632149 0.74215539 0.70923334 0.68405063
 0.65969214 0.63873878 0.6172766  0.59781842 0.58041328 0.56018742
 0.54244984 0.52505306 0.50793744 0.49190592 0.47458531 0.46182744
 0.44860099 0.43495957]
< CSI_POOL 4x4 > : 0.5413620733571064; CSI_POOL 16x16: 0.6984808881757719
====================Threshold: 133 with melthod 1====================
<CSI> : 0.20460727477354707; [0.57975768 0.45214266 0.37438334 0.31887673 0.2800253  0.25085577
 0.22548307 0.20235339 0.18077533 0.16936283 0.1555257  0.13988772
 0.12470193 0.11612872 0.10741745 0.09961647 0.08833014 0.0838349
 0.07412322 0.06856315]
<FAR> : 0.6580108376728778; [0.25223249 0.37729886 0.45890874 0.52611488 0.56627732 0.59317296
 0.62478846 0.65605096 0.68589981 0.69862784 0.70824144 0.72898598
 0.7495602  0.7620271  0.77245414 0.77529127 0.79113453 0.79552424
 0.81535452 0.82227102]
<POD> : 0.3068635518794847; [0.7206976  0.62274856 0.54856382 0.4936341  0.44140655 0.39552153
 0.36104218 0.32954987 0.29868303 0.27883682 0.24985545 0.2242784
 0.19895959 0.1848779  0.16906869 0.15178432 0.13274232 0.12441445
 0.11018962 0.10041623]
<HSS> : 0.3093248018780688; [0.72859887 0.61501109 0.53542143 0.47282369 0.42601056 0.38908967
 0.35555332 0.32360348 0.29273727 0.27599195 0.25559195 0.23175894
 0.20796871 0.19435837 0.18038362 0.16804749 0.14952394 0.14222839
 0.12563082 0.11616248]
< CSI_POOL 4x4 > : 0.3278964489638072; CSI_POOL 16x16: 0.5930242203052422
====================Threshold: 160 with melthod 1====================
<CSI> : 0.13842639084491876; [0.51842126 0.37975144 0.29353539 0.23713333 0.20149503 0.17386852
 0.14431647 0.12712385 0.10926992 0.10603175 0.09557999 0.07531062
 0.06335267 0.05402774 0.04588766 0.04049091 0.03037644 0.02728237
 0.02281906 0.02245339]
<FAR> : 0.7564431749422666; [0.30305948 0.44432628 0.54717776 0.61855228 0.66090082 0.69279942
 0.73492004 0.76539479 0.79020234 0.79014242 0.79864503 0.83142808
 0.85171591 0.86793575 0.88216355 0.88770186 0.90868347 0.91395561
 0.92160943 0.91754917]
<POD> : 0.21111250280383528; [0.66930347 0.54535017 0.45488205 0.38529029 0.3317947  0.28601909
 0.24057143 0.21720881 0.18569577 0.17649131 0.15393881 0.11981567
 0.09959325 0.08377358 0.06990069 0.05955204 0.04353632 0.03841455
 0.03118532 0.02993272]
<HSS> : 0.2195165390287987; [0.68051784 0.54718463 0.44987325 0.37896321 0.33081226 0.29159062
 0.24745144 0.22066873 0.1920999  0.18690706 0.16992694 0.13555334
 0.11475336 0.0982711  0.08365991 0.07411448 0.05547774 0.04981886
 0.04160375 0.04108234]
< CSI_POOL 4x4 > : 0.23790350215886508; CSI_POOL 16x16: 0.4449874686716792
====================Threshold: 181 with melthod 1====================
<CSI> : 0.10872865919768923; [0.47375264 0.32806206 0.24659671 0.18870543 0.15883958 0.13817856
 0.11304078 0.09654954 0.0870062  0.07219115 0.06359971 0.05356103
 0.03985133 0.02765176 0.02090512 0.01936926 0.01374207 0.01160815
 0.00952966 0.01183243]
<FAR> : 0.8035190746534671; [0.34183789 0.50192525 0.60806851 0.68627451 0.72623762 0.74972914
 0.78646749 0.81248079 0.82368508 0.84994716 0.85559717 0.86768936
 0.8966256  0.92223572 0.93636364 0.9332763  0.94710071 0.94868586
 0.9484193  0.92773438]
<POD> : 0.1689911355361659; [0.62836818 0.49008246 0.39940285 0.32136106 0.2745098  0.23577443
 0.19367694 0.16598639 0.14658966 0.12213303 0.10205882 0.08256057
 0.06090249 0.04114433 0.03019244 0.02656676 0.01822643 0.0147801
 0.01155423 0.01395173]
<HSS> : 0.1765439365467083; [0.64168134 0.4923224  0.39359851 0.31525993 0.27189442 0.24060362
 0.20093786 0.17392192 0.15796328 0.13258946 0.11769784 0.09991203
 0.07498989 0.05225872 0.03953272 0.03677357 0.02602504 0.02202421
 0.01814378 0.02274818]
< CSI_POOL 4x4 > : 0.2092646125643376; CSI_POOL 16x16: 0.37266767523953603
====================Threshold: 219 with melthod 1====================
<CSI> : 0.05712322821538479; [0.35633055 0.19839679 0.13049268 0.1065627  0.09222299 0.0839107
 0.05478332 0.04076087 0.02408478 0.01551189 0.01373283 0.00272851
 0.00656814 0.00378788 0.00821355 0.00437637 0.         0.
 0.         0.        ]
<FAR> : 0.8967033251038388; [0.46039036 0.66440678 0.78437844 0.81878453 0.83796856 0.84691011
 0.89297125 0.91949911 0.94802495 0.96287129 0.96028881 0.99126638
 0.97777778 0.98076923 0.93220339 0.95555556 1.         1.
 1.         1.        ]
<POD> : 0.09620938094479528; [0.51198257 0.32673267 0.24841572 0.20551378 0.17631579 0.1566092
 0.10090361 0.07627119 0.04295533 0.02595156 0.02056075 0.00395257
 0.00923788 0.00469484 0.00925926 0.00483092 0.         0.
 0.         0.        ]
<HSS> : 0.096811892895716; [ 5.25109338e-01  3.30645684e-01  2.30363804e-01  1.92078503e-01
  1.68369520e-01  1.54375411e-01  1.03435156e-01  7.79251225e-02
  4.66535944e-02  3.01980131e-02  2.68225834e-02  5.20287106e-03
  1.28590576e-02  7.42056436e-03  1.62153545e-02  8.65320013e-03
 -3.71766691e-05 -2.75504627e-05 -1.91527779e-05 -6.03947320e-06]
< CSI_POOL 4x4 > : 0.16424221921515558; CSI_POOL 16x16: 0.29124236252545826
********************Overall Avg Metrics on Thresholds (16, 74, 133, 160, 181, 219)********************
[ avg_csi ] : 0.2600271766803542; [ avg_far ] : 0.6207329685373161; [ avg_pod ] : 0.3525328748753604; [ avg_hss] : 0.3435827972793512
[ avg_csi_pool 4x4 ] : 0.3504137217054624; [ avg_csi_pool 16x16 ]: 0.5241145150332601
====================Losses with 20 seq_len====================
<MSE> : 593.7603759765625; [ 86.54094 168.33577 252.8383  330.47406 396.98026 446.54175 499.1277
 547.2245  594.53357 636.06696 663.4542  700.1896  731.71136 763.3319
 792.0979  807.7094  832.1455  851.8361  873.55206 900.5164 ]
<MAE> : 10.434320449829102; [ 3.6431484  5.1446714  6.4020357  7.4124656  8.282342   8.855853
  9.465486  10.0510235 10.595102  11.100748  11.42568   11.814475
 12.158314  12.471451  12.773551  12.958943  13.199209  13.402079
 13.630094  13.89973  ]
<RMSE> : 20.922679901123047; [ 8.477301 11.702451 14.216847 16.186207 17.696661 18.708862 19.745132
 20.670717 21.56627  22.29955  22.761408 23.327316 23.82375  24.326483
 24.745037 24.983847 25.340319 25.61623  25.93845  26.320736]
<PSNR> : 23.93655275263789; [30.891825   28.26093659 26.73909138 25.67057148 24.96123492 24.5741165
 24.11861772 23.74009507 23.38330462 23.09211155 22.93478354 22.76147203
 22.60129589 22.4337083  22.32095672 22.24814661 22.11969414 22.05378389
 21.96826116 21.85704793]
<SSIM> : 0.6322753858806953; [0.89134954 0.8235623  0.76726149 0.72319591 0.6867191  0.67071548
 0.64722466 0.62785469 0.61039186 0.59477411 0.58922649 0.5802428
 0.57348973 0.56770979 0.55966619 0.55748631 0.55099401 0.54616583
 0.54208438 0.53539307]
<CRPS> : 0.04091890222188986; [0.01428686 0.02017519 0.02510602 0.02906849 0.03247977 0.03472884
 0.03711955 0.03941578 0.04154942 0.04353233 0.04480659 0.04633127
 0.04767968 0.04890765 0.05009235 0.05081939 0.05176161 0.05255716
 0.05345134 0.05450875]
<LPIPS> : 0.20225325226783752; [0.05861314 0.09227396 0.11372516 0.13510188 0.14968069 0.16671501
 0.18393064 0.18619263 0.19918284 0.21013927 0.22393818 0.23300704
 0.23893821 0.24604781 0.25133795 0.26293522 0.26783693 0.27194265
 0.274244   0.27928182]
==========================================================================================
Test Results: {'csi': 0.2600271766803542}
==============================
