06/02/2025 13:47:00 - INFO - root - ============================================================
06/02/2025 13:47:00 - INFO - root -                  Experiment Start                           
06/02/2025 13:47:00 - INFO - root - ============================================================
06/02/2025 13:47:00 - INFO - root - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: bf16

06/02/2025 13:47:15 - INFO - root - train data: 17859, valid data: 20, test_data: 20
06/02/2025 13:47:15 - INFO - root - Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
06/02/2025 13:47:15 - INFO - root - Main Model Parameters: 49.39M
06/02/2025 13:47:15 - INFO - root - ============ Running training ============
06/02/2025 13:47:15 - INFO - root -     Num examples = 17859
06/02/2025 13:47:15 - INFO - root -     Num Epochs = 1
06/02/2025 13:47:15 - INFO - root -     Instantaneous batch size per GPU = 4
06/02/2025 13:47:15 - INFO - root -     Total train batch size (w. parallel, distributed & accumulation) = 4
06/02/2025 13:47:15 - INFO - root -     Total optimization steps = 17859
06/02/2025 13:47:15 - INFO - root - optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 0.0001
06/02/2025 13:47:15 - INFO - root - Data Loading Time: 0.20319843292236328
06/02/2025 13:47:15 - INFO - root - gpu_nums: 1, gpu_id: 0
06/02/2025 13:47:57 - INFO - root - ============================================================
06/02/2025 13:47:57 - INFO - root -                  Experiment Start                           
06/02/2025 13:47:57 - INFO - root - ============================================================
06/02/2025 13:47:57 - INFO - root - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: bf16

06/02/2025 13:48:11 - INFO - root - train data: 14882, valid data: 20, test_data: 20
06/02/2025 13:48:11 - INFO - root - Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
06/02/2025 13:48:12 - INFO - root - Main Model Parameters: 49.36M
06/02/2025 13:48:12 - INFO - root - ============ Running training ============
06/02/2025 13:48:12 - INFO - root -     Num examples = 14882
06/02/2025 13:48:12 - INFO - root -     Num Epochs = 1
06/02/2025 13:48:12 - INFO - root -     Instantaneous batch size per GPU = 4
06/02/2025 13:48:12 - INFO - root -     Total train batch size (w. parallel, distributed & accumulation) = 4
06/02/2025 13:48:12 - INFO - root -     Total optimization steps = 14882
06/02/2025 13:48:12 - INFO - root - optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 0.0001
06/02/2025 13:48:12 - INFO - root - Data Loading Time: 0.20488977432250977
06/02/2025 13:48:12 - INFO - root - gpu_nums: 1, gpu_id: 0
06/02/2025 13:48:13 - INFO - root - Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
06/02/2025 13:48:13 - INFO - root - milestones: []
06/02/2025 13:48:14 - INFO - root - Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
06/02/2025 13:48:14 - WARNING - py.warnings - /home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(

06/02/2025 13:48:14 - WARNING - py.warnings - /home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

06/02/2025 13:49:17 - INFO - root - ============================================================
06/02/2025 13:49:17 - INFO - root -                  Experiment Start                           
06/02/2025 13:49:17 - INFO - root - ============================================================
06/02/2025 13:49:17 - INFO - root - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: bf16

06/02/2025 13:49:32 - INFO - root - train data: 14882, valid data: 20, test_data: 20
06/02/2025 13:49:32 - INFO - root - Pixel Scale: 255.0, Threshold: (16, 74, 133, 160, 181, 219)
06/02/2025 13:49:32 - INFO - root - Main Model Parameters: 49.36M
06/02/2025 13:49:32 - INFO - root - ============ Running training ============
06/02/2025 13:49:32 - INFO - root -     Num examples = 14882
06/02/2025 13:49:32 - INFO - root -     Num Epochs = 1
06/02/2025 13:49:32 - INFO - root -     Instantaneous batch size per GPU = 4
06/02/2025 13:49:32 - INFO - root -     Total train batch size (w. parallel, distributed & accumulation) = 4
06/02/2025 13:49:32 - INFO - root -     Total optimization steps = 14882
06/02/2025 13:49:32 - INFO - root - optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0
    maximize: False
    weight_decay: 0.0
) with init lr: 0.0001
06/02/2025 13:49:32 - INFO - root - Data Loading Time: 0.21138787269592285
06/02/2025 13:49:32 - INFO - root - gpu_nums: 1, gpu_id: 0
06/02/2025 13:49:33 - INFO - root - Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
06/02/2025 13:49:33 - INFO - root - milestones: []
06/02/2025 13:49:34 - INFO - root - Load checkpoint resources/diffcast_phydnet_sevir128.pt from /home/vatsal/NWM/DiffCast/Exps/basic_exps/Diffphydnet_sevir_None/checkpoints
06/02/2025 13:49:34 - WARNING - py.warnings - /home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and will be removed in 0.15, please use 'weights' instead.
  warnings.warn(

06/02/2025 13:49:34 - WARNING - py.warnings - /home/vatsal/miniconda3/envs/earthformer/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and will be removed in 0.15. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

06/02/2025 13:55:28 - INFO - root - ****************************** < Evaluation Results: > ******************************
06/02/2025 13:55:28 - INFO - root - Total 160 samples with 20 seq_len.
06/02/2025 13:55:28 - INFO - root - ******************************************************************************************
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 16 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.613555448316376; [0.85468235 0.80231825 0.75766017 0.72218868 0.69251    0.67011924
 0.65003538 0.63087038 0.61257206 0.5960846  0.5829288  0.56946709
 0.55633926 0.5428069  0.5309445  0.52089597 0.50917329 0.49889469
 0.49021482 0.48040253]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.24093843080824903; [0.08028126 0.11475155 0.1452548  0.16699732 0.18808584 0.20179054
 0.21532771 0.2300555  0.24183017 0.25435309 0.26311213 0.27133311
 0.28005254 0.28771002 0.2960165  0.30245141 0.31011368 0.3174692
 0.32223568 0.32954655]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.7520720185726065; [0.92358584 0.89544608 0.86963053 0.84444955 0.82483398 0.80679793
 0.79116401 0.7774135  0.76132743 0.74822471 0.73615109 0.72272167
 0.7099882  0.69523955 0.68355121 0.67286726 0.6603041  0.64964776
 0.63918884 0.62890715]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.6832733626323889; [0.89990855 0.85951211 0.82293713 0.79252951 0.76584275 0.74510748
 0.72599616 0.70708672 0.68875508 0.67175813 0.65801132 0.64397066
 0.62984959 0.61518915 0.60206579 0.59087221 0.57797171 0.56629781
 0.55657911 0.5452263 ]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.6618899650394308; CSI_POOL 16x16: 0.7866625121969217
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 74 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.5069479632274009; [0.80333125 0.73199812 0.67578632 0.63564777 0.60025408 0.57347253
 0.54921732 0.52697231 0.50456027 0.48423975 0.46926761 0.45198978
 0.4364996  0.42227131 0.40746382 0.39463373 0.38191128 0.37291638
 0.36353956 0.35298649]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.31046455769219844; [0.10273712 0.14790602 0.18599294 0.21463047 0.2387869  0.25742298
 0.27604353 0.29353878 0.31122486 0.32656104 0.33633121 0.35035499
 0.36181722 0.3732872  0.38457574 0.3935497  0.40352842 0.41002138
 0.41672192 0.42425871]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.6412016199781989; [0.8847084  0.8385433  0.79918987 0.76928264 0.73949804 0.71576784
 0.69469803 0.674706   0.65356437 0.63284042 0.615686   0.59767962
 0.58004518 0.564169   0.54665411 0.53048835 0.51496399 0.50337522
 0.4910906  0.4770814 ]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.6235929845709451; [0.87830378 0.82716902 0.78368121 0.75072936 0.72030053 0.69633034
 0.67386968 0.65254806 0.63058867 0.61012826 0.59480608 0.57663602
 0.55996811 0.54441941 0.52792724 0.51356244 0.49907686 0.48870735
 0.47777171 0.46533557]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.5650152594235092; CSI_POOL 16x16: 0.7317062022944376
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 133 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.22747651404271374; [0.57787831 0.45789461 0.37954404 0.32590616 0.2881613  0.2617874
 0.24021215 0.22159865 0.204039   0.19337991 0.18140927 0.16905592
 0.16225375 0.15370536 0.14243047 0.13389847 0.12528636 0.11815327
 0.10909291 0.10384298]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.6138129961588554; [0.25042975 0.36678345 0.44630718 0.50735306 0.54576174 0.56803002
 0.59671348 0.62073213 0.64535127 0.65685777 0.66300242 0.6788276
 0.68577943 0.69634225 0.70863048 0.70998649 0.71785635 0.7262072
 0.74050573 0.74480211]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.3341434430340378; [0.71614238 0.62318107 0.5468411  0.49055277 0.44076342 0.39921468
 0.3726671  0.34770466 0.32453495 0.30703812 0.28208608 0.26304646
 0.2512116  0.23737336 0.21791707 0.19919406 0.18391071 0.17208192
 0.15840708 0.14900029]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.3413648085000621; [0.72600746 0.61904421 0.53913431 0.47890526 0.43364086 0.40057041
 0.37236396 0.34719231 0.32279944 0.30760257 0.29056955 0.27245602
 0.26233446 0.24957011 0.23228969 0.21944541 0.20618674 0.19495781
 0.1803862  0.17183939]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.35464677837851655; CSI_POOL 16x16: 0.5953690250675886
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 160 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.13806159329970866; [0.48183861 0.34946535 0.27408942 0.22503493 0.18884664 0.16488599
 0.14349414 0.12800204 0.11209657 0.10533231 0.0950503  0.07965885
 0.07248476 0.06270481 0.05640885 0.05135843 0.04574735 0.04455354
 0.04156534 0.03861364]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.7491979999679309; [0.33597973 0.47742614 0.56855606 0.63576159 0.68088962 0.70815797
 0.73939323 0.76189628 0.78577984 0.79302311 0.80008435 0.82384076
 0.83466503 0.85048022 0.85933635 0.8602812  0.86769814 0.8647619
 0.86649844 0.86945005]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.21285378425770868; [0.63718392 0.51337102 0.42906556 0.3706037  0.31629654 0.27485475
 0.24202954 0.216801   0.1903752  0.17660649 0.15340633 0.12695428
 0.11431607 0.09746909 0.08606921 0.07511022 0.06535642 0.06230321
 0.05692182 0.05198132]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.22254078996928026; [0.64789065 0.51455484 0.42621267 0.36291884 0.31290313 0.2781746
 0.24589149 0.221722   0.1962891  0.18526283 0.16849348 0.14246263
 0.1300642  0.11297648 0.10180976 0.09309025 0.0830432  0.08102243
 0.07569891 0.07033432]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.23255408498961508; CSI_POOL 16x16: 0.45110246433203627
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 181 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.11154926851568903; [0.45250124 0.31581794 0.24473684 0.18828486 0.15621196 0.13424157
 0.11463124 0.0985795  0.08753773 0.07572696 0.06312662 0.05520823
 0.04626159 0.03512602 0.03251868 0.02860709 0.02967423 0.02441417
 0.02527806 0.02250084]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.7892267409687521; [0.36687457 0.52352461 0.61462371 0.69042227 0.73252744 0.75552194
 0.7842603  0.80996371 0.82295482 0.84154412 0.85081176 0.86088221
 0.87728938 0.8991453  0.90221682 0.90014524 0.88775925 0.8974359
 0.87974345 0.88688801]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.17410553969215425; [0.61331901 0.48364389 0.40142022 0.32458101 0.27301092 0.22941511
 0.19652504 0.17001181 0.14759343 0.12667157 0.0986365  0.08385683
 0.06912307 0.05114129 0.04645794 0.0385478  0.03877494 0.03104643
 0.03101309 0.02732092]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.1835629755789096; [0.62200798 0.47858105 0.39153365 0.31498663 0.26822491 0.23471618
 0.20370108 0.17745932 0.1589772  0.13880579 0.11690788 0.10287754
 0.08672868 0.06620885 0.06139044 0.0541892  0.05632226 0.04644497
 0.04822959 0.04296632]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.19775948788294465; CSI_POOL 16x16: 0.3570807993049522
06/02/2025 13:55:28 - INFO - root - ====================Threshold: 219 with melthod 1====================
06/02/2025 13:55:28 - INFO - root - <CSI> : 0.05861891750148131; [0.33973655 0.19980459 0.1325245  0.10773357 0.09175162 0.07981928
 0.05942734 0.04398148 0.03115638 0.02492212 0.01744186 0.01186709
 0.00699913 0.00595238 0.00924974 0.0021164  0.00113507 0.00115875
 0.00113122 0.00446927]
06/02/2025 13:55:28 - INFO - root - <FAR> : 0.8890068910641375; [0.4659189  0.66114333 0.77777778 0.81825038 0.83783784 0.84957427
 0.88146552 0.90720391 0.93139842 0.94002999 0.94713656 0.96042216
 0.97350993 0.97014925 0.94578313 0.98425197 0.98888889 0.98901099
 0.99038462 0.96      ]
06/02/2025 13:55:28 - INFO - root - <POD> : 0.0973076838069525; [0.48283931 0.32746197 0.24717145 0.20920139 0.17444934 0.14533821
 0.10648596 0.07715736 0.05399792 0.0408998  0.02536998 0.01666667
 0.00942285 0.00738007 0.01102941 0.00243902 0.00126263 0.00129366
 0.00128041 0.00500626]
06/02/2025 13:55:28 - INFO - root - <HSS> : 0.10037902107153056; [0.50694022 0.33274941 0.23368005 0.1941327  0.16770798 0.14748856
 0.11185642 0.08394467 0.06012584 0.0483443  0.03405964 0.02325709
 0.01373334 0.01171281 0.01822662 0.00414031 0.00220605 0.00225284
 0.00219002 0.00883157]
06/02/2025 13:55:28 - INFO - root - < CSI_POOL 4x4 > : 0.14676987198571004; CSI_POOL 16x16: 0.2695635076681085
06/02/2025 13:55:28 - INFO - root - ********************Overall Avg Metrics on Thresholds (16, 74, 133, 160, 181, 219)********************
06/02/2025 13:55:28 - INFO - root - [ avg_csi ] : 0.2760349508172283; [ avg_far ] : 0.5987746027766873; [ avg_pod ] : 0.3686140148902765; [ avg_hss] : 0.35911899038718603
06/02/2025 13:55:28 - INFO - root - [ avg_csi_pool 4x4 ] : 0.3597725746166211; [ avg_csi_pool 16x16 ]: 0.5319140851440075
06/02/2025 13:55:28 - INFO - root - ====================Losses with 20 seq_len====================
06/02/2025 13:55:28 - INFO - root - <MSE> : 653.3543701171875; [  90.000694  174.70229   261.31067   342.17017   413.87604   468.59555
  528.119     583.6015    638.1196    687.9339    722.35455   764.9067
  805.7077    846.09143   886.48584   910.2223    943.7728    970.2448
  998.55585  1030.3171  ]
06/02/2025 13:55:28 - INFO - root - <MAE> : 11.425878524780273; [ 3.8219464  5.418288   6.768309   7.855002   8.81318    9.493368
 10.198027  10.86565   11.4763365 12.058576  12.461304  12.904726
 13.346941  13.748723  14.165243  14.433908  14.750502  15.030336
 15.303476  15.603724 ]
06/02/2025 13:55:28 - INFO - root - <RMSE> : 21.798656463623047; [ 8.581064  11.847937  14.4018755 16.42241   18.019743  19.12263
 20.276556  21.319164  22.298298  23.131044  23.666553  24.311062
 24.925863  25.524923  26.08826   26.404545  26.853771  27.200298
 27.578579  27.998562 ]
06/02/2025 13:55:28 - INFO - root - <PSNR> : 24.08259207554704; [31.31034898 28.71266524 27.20257583 26.14412447 25.44235413 24.97145969
 24.44075579 23.97224129 23.53078455 23.25569    23.08836929 22.88058624
 22.58223564 22.36444504 22.28109429 22.19759973 22.06971343 21.87464007
 21.73428136 21.59587643]
06/02/2025 13:55:28 - INFO - root - <SSIM> : 0.6179976031668775; [0.88940018 0.81847319 0.75968999 0.71432301 0.67658101 0.65649635
 0.63292831 0.61317543 0.59643853 0.58053169 0.57307658 0.5641977
 0.55586118 0.54901273 0.53998219 0.5375663  0.53303197 0.52728986
 0.52329523 0.51860063]
06/02/2025 13:55:28 - INFO - root - <CRPS> : 0.04480736647461045; [0.01498803 0.02124819 0.02654238 0.03080393 0.0345615  0.0372289
 0.03999228 0.04261039 0.04500523 0.04728854 0.04886786 0.05060676
 0.05234095 0.05391656 0.05554997 0.05660358 0.0578451  0.0589425
 0.06001363 0.06119105]
06/02/2025 13:55:28 - INFO - root - <LPIPS> : 0.19583557546138763; [0.05478717 0.08719067 0.10984957 0.13047554 0.1459451  0.160068
 0.17443024 0.18152323 0.1929996  0.20429894 0.21509027 0.2227325
 0.23090675 0.23796657 0.24298541 0.25271618 0.25990194 0.26576677
 0.270891   0.2761859 ]
06/02/2025 13:55:28 - INFO - root - ==========================================================================================
06/02/2025 13:55:28 - INFO - root - Test Results: {'csi': 0.2760349508172283}
06/02/2025 13:55:28 - INFO - root - ==============================
